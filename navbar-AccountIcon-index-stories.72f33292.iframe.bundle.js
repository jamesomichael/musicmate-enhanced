"use strict";(self.webpackChunkmusicmate_ts=self.webpackChunkmusicmate_ts||[]).push([[803],{"./components/navbar/AccountIcon/index.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Default:()=>Default,__namedExportsOrder:()=>__namedExportsOrder,default:()=>index_stories});var jsx_runtime=__webpack_require__("./node_modules/next/dist/compiled/react/jsx-runtime.js"),react=__webpack_require__("./node_modules/next/dist/compiled/react/index.js"),tb=__webpack_require__("__barrel_optimize__?names=TbExternalLink!=!./node_modules/react-icons/tb/index.mjs"),MenuItem=__webpack_require__("./components/navbar/AccountMenu/MenuItem/index.tsx"),navigation=__webpack_require__("./node_modules/@storybook/nextjs/dist/export-mocks/navigation/index.mjs"),hooks=__webpack_require__("./redux/hooks.ts"),authSlice=__webpack_require__("./redux/slices/authSlice.ts"),console=__webpack_require__("./node_modules/console-browserify/index.js");const hooks_useLogOut=()=>{const dispatch=(0,hooks.jL)(),router=(0,navigation.useRouter)();return(0,react.useCallback)(async()=>{try{await dispatch((0,authSlice.je)()).unwrap(),router.push("/login")}catch(err){console.error("Logout failed",err)}},[dispatch,router])},AccountMenu=({onClose})=>{const user=(0,hooks.GV)(state=>state.user),logOut=hooks_useLogOut();return(0,jsx_runtime.jsx)("div",{className:"absolute right-0 mt-[0.35rem] w-48 bg-neutral-800 rounded-md shadow-lg z-[100]",children:(0,jsx_runtime.jsxs)("div",{className:"p-1 flex flex-col justify-center items-start",children:[(0,jsx_runtime.jsx)(MenuItem.A,{href:"https://www.spotify.com/uk/account/overview",Icon:tb.qGB,iconSize:20,openInNewTab:!0,label:"Account"}),(0,jsx_runtime.jsx)(MenuItem.A,{onClick:onClose,href:`/user/${user.id}`,label:"Profile"}),(0,jsx_runtime.jsx)("div",{className:"w-full border-t border-neutral-500"}),(0,jsx_runtime.jsx)(MenuItem.A,{onClick:logOut,label:"Log out"})]})})},navbar_AccountMenu=AccountMenu;AccountMenu.__docgenInfo={description:"",methods:[],displayName:"AccountMenu",props:{onClose:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}};var useToggle=__webpack_require__("./hooks/useToggle.ts");const hooks_useDropdown=()=>{const{value:isOpen,toggle:toggleOpen,setOff:close}=(0,useToggle.A)(!1),dropdownRef=(0,react.useRef)(null),handleClickOutside=(0,react.useCallback)(event=>{dropdownRef.current&&!dropdownRef.current.contains(event.target)&&close()},[close]);return(0,react.useEffect)(()=>(document.addEventListener("mousedown",handleClickOutside),()=>{document.removeEventListener("mousedown",handleClickOutside)}),[handleClickOutside]),{dropdownRef,isOpen,toggleOpen,close}},AccountIcon=()=>{var _user_id;const user=(0,hooks.GV)(state=>state.user),{dropdownRef,isOpen,toggleOpen}=hooks_useDropdown();return(0,jsx_runtime.jsxs)("div",{className:"h-full relative",ref:dropdownRef,children:[(0,jsx_runtime.jsx)("div",{className:"h-full p-1",children:user.images&&user.images.length>0?(0,jsx_runtime.jsx)("div",{onClick:toggleOpen,className:"transition-all duration-200 hover:cursor-pointer hover:scale-110 bg-cover bg-center aspect-square h-full rounded-full",style:{backgroundImage:`url(${user.images[0].url})`}}):(0,jsx_runtime.jsx)("div",{onClick:toggleOpen,className:"transition-all duration-200 hover:cursor-pointer hover:scale-110 bg-[#f573a0] aspect-square h-full rounded-full flex justify-center items-center",children:(0,jsx_runtime.jsx)("span",{className:"uppercase font-funnel font-bold text-lg",children:user.displayName?user.displayName.charAt(0):null===(_user_id=user.id)||void 0===_user_id?void 0:_user_id.charAt(0)})})}),isOpen&&(0,jsx_runtime.jsx)(navbar_AccountMenu,{onClose:toggleOpen})]})},navbar_AccountIcon=AccountIcon;AccountIcon.__docgenInfo={description:"",methods:[],displayName:"AccountIcon"};var StoreProvider=__webpack_require__("./redux/StoreProvider.tsx");const index_stories={title:"Navbar/AccountIcon",component:navbar_AccountIcon,args:{contextUri:"test-context-uri"},parameters:{layout:"centered"},decorators:[Story=>(0,jsx_runtime.jsx)(StoreProvider.A,{preloadedState:{user:{displayName:"James"}},children:(0,jsx_runtime.jsx)("div",{className:"h-11",children:(0,jsx_runtime.jsx)(Story,{})})})]},Default={},__namedExportsOrder=["Default"]},"./hooks/useToggle.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/next/dist/compiled/react/index.js");const __WEBPACK_DEFAULT_EXPORT__=(initial=!1)=>{const[value,setValue]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(initial);return{value,toggle:(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)(()=>setValue(v=>!v),[]),setOn:(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)(()=>setValue(!0),[]),setOff:(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)(()=>setValue(!1),[])}}},"./redux/hooks.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{GV:()=>useAppSelector,jL:()=>useAppDispatch});var react_redux__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react-redux/dist/react-redux.mjs");const useAppDispatch=react_redux__WEBPACK_IMPORTED_MODULE_0__.wA.withTypes(),useAppSelector=react_redux__WEBPACK_IMPORTED_MODULE_0__.d4.withTypes();react_redux__WEBPACK_IMPORTED_MODULE_0__.Pj.withTypes()}}]);